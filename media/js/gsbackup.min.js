$(document).ready(function(){$(".panel-trigger").click(function(){$(this).next(".panel").slideToggle("fast")});$("#form_install").submit(function(){$("input[type=submit]",this).attr("disabled","disabled")});$("select").change(function(){if($(this).val()=="1"){$(this).next(".panel").slideDown("fast")}else{$(this).next(".panel").slideUp("fast")}});$("select").each(function(){if($(this).val()=="1"){$(this).next(".panel").css("display","block")}});$("input[type='checkbox'][value='all']").change(function(){var a=$(this).attr("name");var b=$(this).attr("checked");$(this).closest("form").find("input[name="+a+"]").each(function(){$(this).attr("checked",b)})});$("input[type='checkbox'][value!='all']").change(function(){var b=$(this).attr("name");var a=$(this).closest("form").find("input[name="+b+"][value='all']");if(a.attr("checked")){a.attr("checked",false)}});$("input.download-button").click(function(){window.location.href="download/"+$(this).attr("name")});$("input.s3-upload-button").click(function(){var a="Upload to S3?";var b=$(this).attr("backup-id");submit_data="type=s3&id="+b;change_popup(a,"submit",true);open_popup();return false});$(".backup-button").click(function(){var b=/backup-(\d+)/.exec($(this).attr("id"));var a=$(this).attr("name");submit_data="type=backup&id="+b[1];action="backup";change_popup("Backup "+a+" now?","submit",true);open_popup()});$("form.confirm").submit(function(d){d.preventDefault();submit_data=$(this).serialize();var c=$(this).children("input[name='type']").val();var b=$(this).find("input[name='name']").val();var f=$(this).children("input[name='id']").val();var e="";var a=false;if(c=="mc"||c=="nc"||c=="otb"){if(b==""){e="You must enter a name.";a=true}else{if(/^[\W]/.test(b)){e="Name must start with a letter or number.";a=true}else{if(/[^a-zA-Z0-9\-_\. ]/.test(b)){e="Name can only contain letters, numbers, spaces, and these characters: ._-";a=true}}}if(!$(this).find(":checked").val()){if(a){e+="<br />"}e+="You must select at least one domain or database.";a=true}}if(c=="eb"){if(!$(this).find(":checked").val()){e="You must select at least one backup to delete.";a=true}}if(a){e='<p class="error">'+e+"</p>";change_popup(e,"none",true);open_popup();return false}if(c=="mc"||c=="nc"){e="Save "+b+"?"}else{if(c=="dc"){e="Delete selected configurations?"}else{if(c=="otb"){action="backup";e="Create backup?"}else{if(c=="settings"){e="Save settings?"}else{if(c=="eb"){e="Delete selected backups?"}}}}}change_popup(e,"submit",true);open_popup();return false});$("#popup-button-submit").click(function(){$.post("update.php",submit_data,function(a){res=$.parseJSON(a);var b;if(res.debug&&typeof(console)!=="undefined"){console.log(res.debug)}if(!res.success){b="Error: "+res.text}else{b=res.text}set_waiting(false);change_popup(b,"close",false)}),"json";if(action=="backup"){change_popup("Please wait...","none",true);set_waiting(true);action==""}return false});$(".popup-close").click(function(){close_popup();location.reload()});$(".popup-cancel").click(function(){close_popup()})});var popup_status=false;var submit_data="";var action="";function open_popup(){if(popup_status){return}center_popup();$("#popup-background").css({opacity:"0.7"});$("#popup-background").fadeIn("fast");$("#popup").fadeIn("slow");popup_status=true}function close_popup(){if(!popup_status){return}$("#popup-background").fadeOut("fast");$("#popup").fadeOut("fast");popup_status=false}function change_popup(c,a,b){if(c&&c!=""){$("#popup-text").html(c)}$("#popup-button-submit").hide();$("#popup-button-close").hide();if(a!="none"){$("#popup-button-"+a).show()}if(b){$("#popup-button-cancel").show()}else{$("#popup-button-cancel").hide()}}function center_popup(){var e=$(window).width();var c=$(window).height();var d=$("#popup").height();var f=$("#popup").width();var b=$(window).scrollLeft();var a=$(window).scrollTop();$("#popup").css({position:"absolute",top:(c/2-d/2)+a,left:(e/2-f/2)+b});$("#popup-background").css({height:c,width:e})}function set_waiting(a){var b="auto";if(a){b="progress"}$("#popup").css("cursor",b);$("#popup-background").css("cursor",b)};